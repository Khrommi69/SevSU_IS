CONNECT "D:\SevSU_IS\4_Sem\Data management\lab_4\DATABASE.FDB" user 'SYSDBA' password 'masterkey';

SHOW TABLES;
SELECT * FROM COMPANY;
SELECT * FROM ROOM;
SELECT * FROM ROOM_TYPE;
SELECT * FROM TELEPHONE;
SELECT * FROM COUNTERPARTY;

SELECT ROOM.COMPANY_NUM, TELEPHONE.PHONE_NUM
FROM ROOM, TELEPHONE
WHERE ROOM.ADRESS = TELEPHONE.ADRESS;

SELECT ROOM.COMPANY_NUM, TELEPHONE.PHONE_NUM
FROM ROOM JOIN TELEPHONE
ON ROOM.ADRESS = TELEPHONE.ADRESS;

SELECT ROOM.COMPANY_NUM, ROOM_TYPE.ROOM_TYPE, TELEPHONE.PHONE_NUM
FROM ROOM, TELEPHONE, ROOM_TYPE
WHERE ROOM.ADRESS = TELEPHONE.ADRESS AND
ROOM_TYPE.ROOM_TYPE_NUM = ROOM.ROOM_TYPE_NUM;

SELECT ROOM.COMPANY_NUM, ROOM_TYPE.ROOM_TYPE, TELEPHONE.PHONE_NUM
FROM (ROOM JOIN TELEPHONE ON ROOM.ADRESS = TELEPHONE.ADRESS)
JOIN ROOM_TYPE ON ROOM_TYPE.ROOM_TYPE_NUM = ROOM.ROOM_TYPE_NUM
ORDER BY ROOM.COMPANY_NUM;

SELECT first.COMPANY_NUM, second.COMPANY_NUM, first.ROOM_TYPE_NUM
FROM Room first, Room second
WHERE first.ROOM_TYPE_NUM = second.ROOM_TYPE_NUM;

SELECT AREA_SIZE, ROOM_TYPE_NUM, COMPANY_NUM FROM ROOM
WHERE COMPANY_NUM = 
	(SELECT COMPANY_NUM FROM COMPANY
	 WHERE COMPANY_NAME = 'Flour_master');

SELECT COMPANY_NUM, PHONE_NUM FROM TELEPHONE
WHERE COMPANY_NUM <
	(SELECT AVG(COMPANY_NUM) FROM COMPANY);

SELECT * FROM ROOM
WHERE ROOM_TYPE_NUM IN
	(SELECT ROOM_TYPE_NUM FROM ROOM_TYPE
	 WHERE ROOM_TYPE <> '<null>');


SELECT * FROM CUSTOMERS
WHERE CNUM = 
	(SELECT SNUM+1000
	 FROM SALESPEOPLE
	 WHERE SNAME = 'SERRES');

SELECT COMPANY_NUM, ROOM_TYPE_NUM FROM ROOM
WHERE AREA_SIZE <
	(SELECT ROOM_TYPE_NUM/100000 FROM ROOM_TYPE
	 WHERE ROOM_TYPE = 'Office');


SELECT COMPANY_NUM, AVG(AREA_SIZE) AS AVG_AREA_SIZE FROM ROOM
GROUP BY COMPANY_NUM
HAVING AVG(AREA_SIZE) >
	(SELECT AVG(AREA_SIZE) FROM ROOM
	 WHERE  COMPANY_NUM <> 74792076);





